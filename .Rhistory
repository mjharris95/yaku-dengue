guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(palette = "BrBG")+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG")+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG", breaks=10)+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG", breaks=seq(from=-15, to=15, by=5))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG", breaks=seq(from=-15, to=15, by=3))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG", breaks=seq(from=-15, to=15, by=3))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15),
trans="sqrt")+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
S_sqrt_trans <- function() trans_new("S_sqrt",S_sqrt,IS_sqrt)
# initialize signed sqrt transform (from https://andrewpwheeler.com/2015/07/31/custom-square-root-scale-with-negative-values-in-ggplot2-r/)
S_sqrt <- function(x){sign(x)*sqrt(abs(x))}
IS_sqrt <- function(x){x^2*sign(x)}
S_sqrt_trans <- function() trans_new("S_sqrt",S_sqrt,IS_sqrt)
# initialize signed sqrt transform (from https://andrewpwheeler.com/2015/07/31/custom-square-root-scale-with-negative-values-in-ggplot2-r/)
S_sqrt <- function(x){sign(x)*sqrt(abs(x))}
IS_sqrt <- function(x){x^2*sign(x)}
S_sqrt_trans <- function() trans_new("S_sqrt",S_sqrt,IS_sqrt)
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15), trans="S_sqrt")+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15), trans="S_sqrt")+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
# initialize signed sqrt transform (from https://andrewpwheeler.com/2015/07/31/custom-square-root-scale-with-negative-values-in-ggplot2-r/)
S_sqrt <- function(x){sign(x)*sqrt(abs(x))}
IS_sqrt <- function(x){x^2*sign(x)}
library(scales)
# initialize signed sqrt transform (from https://andrewpwheeler.com/2015/07/31/custom-square-root-scale-with-negative-values-in-ggplot2-r/)
S_sqrt <- function(x){sign(x)*sqrt(abs(x))}
IS_sqrt <- function(x){x^2*sign(x)}
S_sqrt_trans <- function() trans_new("S_sqrt",S_sqrt,IS_sqrt)
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15), trans="S_sqrt")+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15),
trans="S_sqrt",breaks = c(-15, -10, -5, 0, 5, 10, 15))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15),
trans="S_sqrt", breaks = c(-15, -10, -5, 0, 5, 10, 15),
labels= c(-15, -10, -5, 0, 5, 10, 15))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_distiller(type="div", palette = "BrBG", limits=c(-15, 15),
transform="S_sqrt", breaks = c(-15, -10, -5, 0, 5, 10, 15),
labels= c(-15, -10, -5, 0, 5, 10, 15))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# Time series: raw inc over time in extreme vs non-extreme precip
group_pop <- rbind(pop_df %>%
filter(id %in% match_out_allper$treated_names) %>%
mutate(group = "Extreme Precip."),
pop_df %>%
filter(id %in% match_out_allper$match_names) %>%
mutate(group = "Matched Control"),
pop_df %>%
filter(id %in% setdiff(cases_2023, match_out_allper$treated_names)) %>%
mutate(group = "Non-extreme Precip.")) %>%
group_by(year, group) %>%
summarize(pop = sum(pop, na.rm=TRUE))
case_df_weekly <- case_df %>%
mutate(date = ymd(paste(year, 1, 1, sep = "-")) + weeks(week - 1)) %>%
filter(year >= 2016)
inc_data <- rbind(case_df_weekly %>%
filter(id %in% match_out_allper$treated_names) %>%
mutate(group = "Extreme Precip."),
case_df_weekly %>%
filter(id %in% match_out_allper$match_names) %>%
mutate(group = "Matched Control"),
case_df_weekly %>%
filter(id %in% setdiff(cases_2023, match_out_allper$treated_names)) %>%
mutate(group = "Non-extreme Precip.")) %>%
group_by(date, group, year) %>%
summarize(cases = sum(cases)) %>%
left_join(group_pop) %>%
mutate(incidence = cases/pop*1000) %>%
distinct()
head(inc_data)
head(inc_data) %>% group_by(group, year) %>% summarize(total = sum(incidence))
inc_data %>% group_by(group, year) %>% summarize(total = sum(incidence))
inc_data %>% group_by(group, year) %>% summarize(total = sum(incidence)) %>% filter(year %in% c(2023, 2022, 2015, 2017))
case_df_weekly <- case_df %>%
mutate(date = ymd(paste(year, 1, 1, sep = "-")) + weeks(week - 1))# %>%
inc_data %>% group_by(group, year) %>% summarize(total = sum(incidence)) %>% filter(group=="Extreme Precip.")
case_df_weekly <- case_df %>%
mutate(date = ymd(paste(year, 1, 1, sep = "-")) + weeks(week - 1))
unique(case_df$year)
inc_data %>% group_by(group, year) %>% summarize(total = sum(incidence)) %>% filter(group=="Extreme Precip.")
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15),
breaks=seq(from=-15,to=15, by=3))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15),
breaks=seq(from=-15,to=15, by=5))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15),
breaks=seq(from=-15,to=15, by=3),
labels=seq(from=-12, to=12, by=6))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15),
breaks=seq(from=-15,to=15, by=3))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15),
breaks=seq(from=-15,to=15, by=3),
labels=seq(from=-15,to=15, by=3) %>% ifelse(.%% 6 == 0, ., ""))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15),
breaks=seq(from=-15,to=15, by=3),
labels=seq(from=-15,to=15, by=3) %>% ifelse(.%% 6 == 0, ., ""))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2b <- ggplot() +
geom_sf(data=map3, aes(fill=mean_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_viridis("Historical Precipitation (mm/day)", option="viridis",
direction = -1)+
theme_void() +
theme(legend.position="bottom")+
guides(fill = guide_colourbar(title.position="top", title.hjust = 0.5, barwidth=11))
p2c <- ggplot()+
geom_sf(data=map3, aes(fill=mean_temp),col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_viridis("Historical Temperature (C)", option="plasma", breaks=c(5, 10, 15, 20, 25))+
theme_void() +
theme(legend.position="bottom")+
guides(fill = guide_colourbar(title.position="top", title.hjust = 0.5, barwidth=11))
plot_grid(p2a, p2b, p2c, nrow=1, labels="AUTO", rel_widths=c(1,1,1), align="h")
#ggsave("figs/climate_map.pdf", height=4, width=8, units="in")
ggsave("figs/climate_map.png", dpi=320, height=4, width=8, units="in")
?scale_fill_fermenter
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15), direction=-1,
breaks=seq(from=-15,to=15, by=3),
labels=seq(from=-15,to=15, by=3) %>% ifelse(.%% 6 == 0, ., ""))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
#ggsave("figs/climate_map.pdf", height=4, width=8, units="in")
ggsave("figs/climate_map.png", dpi=320, height=4, width=8, units="in")
plot_grid(p2a, p2b, p2c, nrow=1, labels="AUTO", rel_widths=c(1,1,1), align="h")
#ggsave("figs/climate_map.pdf", height=4, width=8, units="in")
ggsave("figs/climate_map.png", dpi=320, height=4, width=8, units="in")
p2a
# merge data and plot for adm1
p2a <- ggplot() +
geom_sf(data=map3, aes(fill=diff_rain*1000), col=NA) +
geom_sf(data = extreme_map3, col = "black", fill=NA, linewidth = .4)+ # bold outline of extreme precip districts
geom_sf_pattern(data = match_map3, pattern="stripe", pattern_angle=30,
pattern_size=.3, pattern_density=.5, pattern_spacing=.03,
pattern_linetype="dotted",
pattern_fill=NA, pattern_colour="black",
fill=NA, col=NA)+
scale_fill_fermenter(type="div", palette = "BrBG",
limits=c(-15, 15), direction=1,
breaks=seq(from=-15,to=15, by=3),
labels=seq(from=-15,to=15, by=3) %>% ifelse(.%% 6 == 0, ., ""))+
theme_void() +
theme(legend.position="bottom")+
annotation_scale(style="ticks", pad_x= unit(0, "cm"))+
guides(fill = guide_colourbar("Precipitation Anomaly (mm/day)",
title.position="top", title.hjust = 0.5,
barwidth=11))
p2a
plot_grid(p2a, p2b, p2c, nrow=1, labels="AUTO", rel_widths=c(1,1,1), align="h")
#ggsave("figs/climate_map.pdf", height=4, width=8, units="in")
ggsave("figs/climate_map.png", dpi=320, height=4, width=8, units="in")
